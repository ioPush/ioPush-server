<!-- extend base layout -->
{% extends "base.html" %}

{% block content %}
  <div class="well well-sm">
    <h2>{{ current_user.nickname }}'s profile</h2>
  </div>
  <dl class="dl-horizontal">
    <dt>Email</dt><dd>{{ user.email }}</dd>
    <dt>Auth token</dt><dd>{{ user.auth_token }}</dd>
    <dt>Password</dt><dd><a class="btn btn-default btn-xxs" href="{{ url_for('security.change_password') }}" role="button">Change</a></dd>
    <dt>Account</dt><dd><a class="btn btn-default btn-xxs" href="{{ url_for('deleteUser', nickname=current_user.nickname) }}" role="button">Delete</a></dd>
    <dt>Devices</dt>
      <dd><table>
        {% for device in devices %}
          <tr>
            <td>{{ device.name }}&nbsp;&nbsp;&nbsp;&nbsp;</td>
            <td><a class="btn btn-default btn-xxs" href="{{ url_for('deleteDevice', deviceId=device.id) }}" role="button">Delete</a></td>
          </tr>
        {% endfor %}
      </table></dd>
  </dl>
  <ul class="list-group">
    {% for post in posts %}
      <li class="list-group-item">
        <div class="container-fluid" id="post-meta">
            <div class="col-xs-4">
              <script type="text/javascript">
                var locale = window.navigator.userLanguage || window.navigator.language;
                moment.locale(locale);
                document.write(moment("{{ post.timestamp.strftime("%Y-%m-%d %H:%M:%S Z") }}").fromNow());
              </script>
            </div>
            <div class="col-xs-4">
              <script type="text/javascript">
                var locale = window.navigator.userLanguage || window.navigator.language;
                moment.locale(locale);
                document.write(moment("{{ post.timestamp.strftime("%Y-%m-%d %H:%M:%S Z") }}").format('L - LT'));
              </script>
            </div>  
            <div class="col-xs-4">
              <a class="btn btn-default btn-xxxs" role="button" href="{{ url_for('deletePost', postId=post.id) }}">Delete</a>
            </div>
        </div>
        <div class="container-fluid" id="post">
          <div class="col-xs-1">
          {% if post.badge is equalto('W') %}<span class="pull-right label label-warning">Warning</span>{% endif %}
            {% if post.badge is equalto('E') %}<span class="pull-right label label-danger">Error</span>{% endif %}
            {% if post.badge is equalto('S') %}<span class="pull-right label label-success">OK</span>{% endif %}
            {% if post.badge is equalto('I') %}<span class="pull-right label label-info">Info</span>{% endif %}
          </div>
          <div class="col-xs-11">
            {{ post.body }}
            
          </div>
        </div>
      </li>
    {% endfor %}
  </ul>
{% endblock %}
